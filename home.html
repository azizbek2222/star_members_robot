<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <title>Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0e1621;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      min-height: 100vh;
      padding: 20px;
    }
    #welcome {
      color: #4fc3f7;
      text-align: center;
      margin-bottom: 30px;
      font-size: 28px;
    }
    #coin {
      text-align: center;
      color: #ffca28;
      margin-bottom: 50px;
      font-size: 20px;
    }
    .btn {
      padding: 15px 30px;
      margin: 10px 0;
      font-size: 18px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      transition: 0.3s;
      width: 200px;
    }
    .sub-btn {
      background: #4caf50;
      color: #fff;
    }
    .sub-btn:hover {
      background: #45a049;
    }
    .order-btn {
      background: #2196f3;
      color: #fff;
    }
    .order-btn:hover {
      background: #1976d2;
    }
  </style>
</head>
<body>

<h1 id="welcome">Welcome, User</h1>
<h2 id="coin">Coins: 0</h2>

<button class="btn sub-btn" id="subscribeBtn">Subscribe</button>
<button class="btn order-btn" id="createOrderBtn">Create Order</button>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
import { getDatabase, ref, get, onValue } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-database.js";

/* ðŸ”¹ Firebase config */
const firebaseConfig = {
  apiKey: "AIzaSyA7VLHdjPqf_tobSiBczGbN8H7YlFwq9Wg",
  authDomain: "magnetic-alloy-467611-u7.firebaseapp.com",
  databaseURL: "https://magnetic-alloy-467611-u7-default-rtdb.firebaseio.com",
  projectId: "magnetic-alloy-467611-u7",
  storageBucket: "magnetic-alloy-467611-u7.firebasestorage.app",
  messagingSenderId: "589500919880",
  appId: "1:589500919880:web:15c3e68f5e7e1fbf51687d"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ðŸ”¹ USER ID TEKSHIRISH */
const params = new URLSearchParams(window.location.search);
const userId = params.get("user");
if (!userId) {
  alert("Login qilinmagan!");
  window.location.href = "index.html";
  throw new Error("User ID yoâ€˜q");
}

/* ðŸ”¹ User coin koâ€˜rsatish */
const userRef = ref(db, "users/" + userId);
onValue(userRef, snap => {
  if (!snap.exists()) return;
  const u = snap.val();
  document.getElementById("welcome").innerText = "Welcome, " + (u.name || "User");
  document.getElementById("coin").innerText = "Coins: " + (u.coin || 0);
});

/* ðŸ”¹ Tugmalarni ishlatish */
document.getElementById("subscribeBtn").onclick = () => {
  window.location.href = "subscribe.html?user=" + userId;
};

document.getElementById("createOrderBtn").onclick = () => {
  window.location.href = "create-order.html?user=" + userId;
};
</script>

</body>
</html>